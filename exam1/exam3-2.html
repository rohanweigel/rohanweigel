<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Exam 1 Chart - Stacked</title>
        <script type="text/javascript" src="http://d3js.org/d3.v2.js"></script>
        <script type="text/javascript" src="http://localhost:8888/exam1.json"></script>
        
    </head>
    <body>
        <div class=title>
        <h2>Stacked Bar Chart - 5 Universities</h2>
        </div>
        <style type = "text/css">
        div.title {
            margin-left: 400px;
            padding-top: -50px;
        }
        </style>
        <style type = "text/css">
    div.bar {
				display: inline-block;
			}
            .axis path,
			.axis line {
				fill: none;
				stroke: black;
				shape-rendering: crispEdges;
            }
            .axis text {
				font-family: sans-serif;
				font-size: 11px;
			}
                rect:hover {
        fill: orange;
}
            {
                margin-left: 200px;
                margin-top: -200px;
            }
            
            </style>
    </body>
    <svg class="chart"></svg>
    <script src="http://d3js.org/d3.v2.js"></script>
<script type="text/javascript">

//var dataset = [90, 91, 46, 100, 92];
    var dataset
    
    d3.json("exam1.json", function(data) {
    var dataset = data;
        console.log(dataset);
        
        
    });
    var stack = d3.layout.stack();
    
    stack(dataset);
    
    console.log(dataset);
    
var w = 500,
    h = 500;
    var barPadding = 20;
    var padding = 20;
    
    
    
    
    //x stuff
    var xScale = d3.scale.ordinal()
    .domain(["University A", "University B","University C","University D","University E"])
    .rangeRoundBands([0, w], .1);
    
    var xAxis = d3.svg.axis()
							  .scale(xScale)
							  .orient("bottom")
    //y stuff
    var yScale = d3.scale.linear()
    .range([h - padding, h]);
    
    
    
    var yAxis = d3.svg.axis()
							  .scale(yScale)
							  .orient("left")
							  .ticks(5);
    //color stuff
    var color = d3.scale.ordinal()
    .range(["#98abc5", "#8a89a6", "#7b6888", "#6b486b", "#a05d56"]);
    
    var svg = d3.select("body")
            .append("svg")
            .attr("width", w)
            .attr("height", h);
    
    var groups = svg.selectAll("g")
				.data(dataset)
				.enter()
				.append("g")
				.style("fill", function(d, i) {
					return colors(i);
				});
    
    var rects = groups.selectAll("rect")
				.data(function(d) { return d; })
				.enter()
				.append("rect")
				.attr("x", function(d, i) {
					return xScale(i);
				})
				.attr("y", function(d) {
					return yScale(d.y0);
				})
				.attr("height", function(d) {
					return yScale(d.y);
				})
				.attr("width", xScale.rangeBand());
    
    //bars
    svg.selectAll("rect")
   .data(dataset)
   .enter()
   .append("rect")
   .attr("x", function(d, i) {
			   		return i * (w / dataset.length) + 30;
    })
   .attr("y", function(d) {
    return h - (d * 3) - 30;
    })
   .attr("width", w / dataset.length - barPadding)
    .attr("fill", "blue")
   .attr("height", function(d) {
    return d * 3;
    })
    .attr("fill", function(d) {
					return "rgb(0, 0, " + (d * 10) + ")";
			   })
    .on("click", function(d) {
             console.log(d);
});

        //labels
    svg.selectAll("text")
			   .data(dataset)
			   .enter()
			   .append("text")
			   .text(function(d) {
			   		return d;
			   })
			   .attr("x", function(d, i) {
			   		return i * (w / dataset.length) + 56;
			   })
			   .attr("y", function(d) {
			   		return h - (d * 3) + 10;
			   })
			   .attr("font-family", "helvetica")
			   .attr("font-size", "20px")
			   .attr("fill", "white");
    
    //x axis
    svg.append("g")
				.attr("class", "axis")
				.attr("transform", "translate(15," + (h - padding) + ")")
                .attr("x", 10)
				.call(xAxis);
    
    //y axis
    svg.append("g")
				.attr("class", "axis")
				.attr("transform", "translate(" + (padding + 6) + ",0)")
				.call(yAxis)
               .append("text")
                .attr("class", "label")
                .attr("transform", "rotate(-90)")
                .attr("y", 10)
                .attr("x",-150)
                .attr("dy", ".35em")
                .style("text-anchor", "end")
                .text("Scores");
    </script>
</html>